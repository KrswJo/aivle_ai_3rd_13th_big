<html>
  <head>
  </head>
  <body>
    <form method="post" action="{% url 'payment:upload' %}" enctype="multipart/form-data">
      <div class="wrap">
        <p>capture</p>
        <br> 
        <p>1.전면 카메라</p>
        <input class="form-control" type="file" accept="image/*" capture="user" onchange="viewImage(this,document.getElementById('img0'))">
        <br>
        <img id="img0" src="about:blank" style="max-width:300px;max-height:300px;display:block; border:1px dotted black;">
        <p>2.후면 카메라</p>
        <input class="form-control" type="file" accept="image/*" capture="environment" onchange="viewImage(this,document.getElementById('img1'))">
        <br>
        <img id="img1" src="about:blank" style="max-width:300px;max-height:300px;display:block; border:1px dotted black;">
        <p>3.비디오</p>
        <input class="form-control" type="file" accept="video/*" capture="" onchange="viewImage(this,document.getElementById('video0'))">
        <br>
        <video src="about:blank" width="400" height="300" controls="" id="video0"></video>
      </div>
      <div><input type="submit" value="결제"></div>
    </form>
    <!-- 웹캠 -->
    <div><video id="video" width="800" height="600" autoplay></video></div>
    <button onclick="captureImage()">캡쳐</button>
    <br>
    <div id="image-container"></div>
  </body>

  <script>
    // 웹캠용 스크립트
    const video = document.getElementById('video');
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');
    
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
      });
    
    function captureImage() {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      context.drawImage(video, 0, 0);
    }
    const imageContainer = document.getElementById('image-container');
    imageContainer.appendChild(canvas);

    // 이미지용 스크립트
		function viewImage(input_file,img){
			(function(file){
				var fileReader = new FileReader();
				fileReader.onload = function (event) {
					// 	var img = new Image();
					// 	img.src = event.target.result;
					// 	preview.appendChild(img);
					img.src = event.target.result;
					
				};
				fileReader.readAsDataURL(file);
			})(input_file.files[0])
		}
	

  </script>
</html>